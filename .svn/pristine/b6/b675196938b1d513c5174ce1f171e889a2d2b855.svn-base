// baseInfo.js
var cardtype
//获取应用实例
var app = getApp()
Page({

  /**
   * 页面的初始数据
   */
  data: {

  },

  /**
   * 生命周期函数--监听页面加载
   */
  onLoad: function (options) {
    var that = this
    //调用应用实例的方法获取全局数据
    console.log('app.globalData.user:', app.globalData.user)
    // 1.身份证号 2.驾驶证 3.护照 4.军官证号
    if ('1' == app.globalData.user.cardType) {
      cardtype = '身份证号'
    } else if ('2' == app.globalData.user.cardType) {
      cardtype = '驾驶证'
    } else if ('3' == app.globalData.user.cardType) {
      cardtype = '护照'
    } else if ('4' == app.globalData.user.cardType) {
      cardtype = '军官证号'
    }
    //更新数据
    that.setData({
      userInfo: app.globalData.userInfo,
      name: app.globalData.userInfo.nickName,
      account: app.globalData.user.account,
      address: app.globalData.user.address,
      startTime: app.globalData.user.startTime,
      endTime: app.globalData.user.endTime,
      joiningTime: app.globalData.user.joiningTime,
      salary: app.globalData.user.salary,
      cardType: cardtype,
      idcard: that.hideIdcard(app.globalData.user.idcard),
      phone: app.globalData.user.phone
    })
  },
  hideIdcard: function (idcard) {
    var idcard = idcard
    if (null == idcard) {
      return "-";
    }
    var idcardLength = idcard.length;
    //身份证号分为15位和18位两种  隐藏生日
    if (18 == idcardLength) {//18位
      var startIdcard = idcard.substring(0, idcardLength - 8);
      var endIdcard = idcard.substring(idcardLength - 4, idcardLength);
      return startIdcard + "****" + endIdcard;
    }
    if (15 == idcardLength) {//15位
      var startIdcard = idcard.substring(0, idcardLength - 7);
      var endIdcard = idcard.substring(idcardLength - 3, idcardLength);
      return startIdcard + "****" + endIdcard;
    }
    //军官证,回乡证等
    if (idcardLength > 5) {
      var startSub = idcardLength / 2 - 1;
      var startIdcard = idcard.substring(0, startSub - 1);
      var endIdcard = idcard.substring(startSub + 1, idcardLength);
      return startIdcard + "**" + endIdcard;
    } else {
      return idcard;
    }
  },
  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady: function () {

  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow: function () {

  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide: function () {

  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload: function () {

  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function () {

  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function () {

  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage: function () {

  }
})